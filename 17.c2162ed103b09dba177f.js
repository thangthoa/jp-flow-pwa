/*! @version pwa-studio: 0.0.1, @magento/venia-ui: ~10.3.0, @magento/venia-sample-payments-checkmo: ^0.0.12, @magento/upward-security-headers: ~1.0.14, @magento/pwa-theme-venia: ~1.4.0, @magento/pwa-buildpack: ~11.4.3, @magento/peregrine: ~13.1.1, @magento/pagebuilder: ~8.2.1, @magento/eslint-config: ~1.5.0, @magento/babel-preset-peregrine: ~1.2.3, @apollo/client: ~3.6.9 */
(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{"0Hm9":function(e,t,r){"use strict"
var n=r("JPst"),s=r.n(n)()(function(e){return e[1]})
s.push([e.i,".region-root-1B2 {\n    grid-area: state;\n}\n",""]),s.locals={root:"region-root-1B2"},t.a=s},"36gI":function(e,t,r){"use strict"
r.d(t,"a",function(){return I})
var n,s=r("lSNA"),o=r.n(s),a=r("q1tI"),i=r("+TN3"),c=r("pZLH"),d=r("OlZo"),l=r("FITH"),u=r("y1Xp"),b=r("VkAN"),p=r.n(b),f=r("UYTu")
const y=Object(f.a)(n||(n=p()(["\n    fragment CustomerAddressBookAddressFragment on CustomerAddress {\n        __typename\n        id\n        city\n        country_code\n        default_billing\n        default_shipping\n        firstname\n        lastname\n        middlename\n        postcode\n        region {\n            region\n            region_code\n            region_id\n        }\n        street\n        telephone\n    }\n"])))
var g,O,j,m
const h=Object(f.a)(g||(g=p()(["\n    query GetCustomerAddressesForAddressBook {\n        # eslint-disable-next-line @graphql-eslint/require-id-when-available\n        customer {\n            addresses {\n                id\n                ...CustomerAddressBookAddressFragment\n            }\n        }\n        countries {\n            id\n            full_name_locale\n        }\n    }\n    ","\n"])),y),w=Object(f.a)(O||(O=p()(["\n    mutation AddNewCustomerAddressToAddressBook(\n        $address: CustomerAddressInput!\n    ) {\n        createCustomerAddress(input: $address) {\n            # We don't manually write to the cache to update the collection\n            # after adding a new address so there's no need to query for a bunch\n            # of address fields here. We use refetchQueries to refresh the list.\n            id\n        }\n    }\n"]))),C=Object(f.a)(j||(j=p()(["\n    mutation UpdateCustomerAddressInAddressBook(\n        $addressId: Int!\n        $updated_address: CustomerAddressInput!\n    ) {\n        updateCustomerAddress(id: $addressId, input: $updated_address) {\n            id\n            ...CustomerAddressBookAddressFragment\n        }\n    }\n    ","\n"])),y)
var A={createCustomerAddressMutation:w,deleteCustomerAddressMutation:Object(f.a)(m||(m=p()(["\n    mutation DeleteCustomerAddressFromAddressBook($addressId: Int!) {\n        deleteCustomerAddress(id: $addressId)\n    }\n"]))),getCustomerAddressesQuery:h,updateCustomerAddressMutation:C},v=r("Cess")
function ownKeys(e,t){var r=Object.keys(e)
if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e)
t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{}
t%2?ownKeys(Object(r),!0).forEach(function(t){o()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}const I=function useAddressBookPage(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
const t=Object(u.a)(A,e.operations),{createCustomerAddressMutation:r,deleteCustomerAddressMutation:n,getCustomerAddressesQuery:s,updateCustomerAddressMutation:o}=t,[,{actions:{setPageLoading:b}}]=Object(d.b)(),[{isSignedIn:p,currentUser:f}]=Object(l.b)(),[,{dispatch:y}]=Object(v.b)(),{data:g,loading:O}=Object(i.b)(s,{fetchPolicy:"cache-and-network",skip:!p}),[j,{loading:m}]=Object(c.a)(n),[h,w]=Object(a.useState)(),C=!!g&&O,I=g&&g.customer&&g.customer.addresses||[],[S,{error:P,loading:_}]=Object(c.a)(r),[E,{error:D,loading:k}]=Object(c.a)(o),[T,M]=Object(a.useState)(!1),[K,R]=Object(a.useState)(!1),[q,L]=Object(a.useState)({}),[V,F]=Object(a.useState)(!1)
Object(a.useEffect)(()=>{b(C)},[C,b])
const Q=Object(a.useCallback)(()=>{F(!1),R(!1),L({country_code:"US"}),M(!0)},[]),U=Object(a.useCallback)(e=>{w(e)},[]),B=Object(a.useCallback)(()=>{w(null)},[]),N=Object(a.useCallback)(async()=>{try{await j({variables:{addressId:h},refetchQueries:[{query:s}],awaitRefetchQueries:!0}),y({type:"USER_ADDRESS_DELETE",payload:{addressId:h,user:f}}),w(null)}catch(e){return}},[h,j,s,y,f]),J=Object(a.useCallback)(e=>{F(!1),R(!0),L(e),M(!0)},[]),$=Object(a.useCallback)(()=>{M(!1)},[]),X=Object(a.useCallback)(async e=>{if(K)try{const t=_objectSpread(_objectSpread({},e),{},{middlename:e.middlename||"",street:e.street.filter(e=>e)})
await E({variables:{addressId:q.id,updated_address:t},refetchQueries:[{query:s}],awaitRefetchQueries:!0}),y({type:"USER_ADDRESS_EDIT",payload:{id:q.id,address:t,user:f}}),M(!1)}catch(e){return void F(!0)}else try{const t=_objectSpread(_objectSpread({},e),{},{middlename:e.middlename||"",street:e.street.filter(e=>e)})
await S({variables:{address:t},refetchQueries:[{query:s}],awaitRefetchQueries:!0}),y({type:"USER_ADDRESS_CREATE",payload:{address:t,user:f}}),M(!1)}catch(e){return void F(!0)}},[S,q,s,K,E,y,f]),x=Object(a.useMemo)(()=>V?new Map([["createCustomerAddressMutation",P],["updateCustomerAddressMutation",D]]):new Map,[P,V,D]),W=Object(a.useMemo)(()=>{const e=new Map
if(g){const{countries:t}=g
t.forEach(t=>{e.set(t.id,t.full_name_locale)})}return e},[g])
return{confirmDeleteAddressId:h,countryDisplayNameMap:W,customerAddresses:I,formErrors:x,formProps:{initialValues:q},handleAddAddress:Q,handleCancelDeleteAddress:B,handleCancelDialog:$,handleConfirmDeleteAddress:N,handleConfirmDialog:X,handleDeleteAddress:U,handleEditAddress:J,isDeletingCustomerAddress:m,isDialogBusy:_||k,isDialogEditMode:K,isDialogOpen:T,isLoading:!g&&O}}},SYKJ:function(e,t,r){"use strict"
var n=r("JPst"),s=r.n(n)()(function(e){return e[1]})
s.push([e.i,".country-root-k1e {\n    grid-area: country;\n}\n",""]),s.locals={root:"country-root-k1e"},t.a=s},SuX4:function(e,t,r){"use strict"
var n=r("pVnL"),s=r.n(n),o=r("lSNA"),a=r.n(o),i=r("QILm"),c=r.n(i),d=r("q1tI"),l=r.n(d),u=r("dDsW"),b=r("17x9"),p=r("+TN3")
var f,y=r("y1Xp"),g=r("U2T0"),O=r("cXIJ"),j=r("LboF"),m=r.n(j),h=r("SYKJ"),w={injectType:"singletonStyleTag",insert:"head",singleton:!0},C=(m()(h.a,w),h.a.locals||{}),A=r("VkAN"),v=r.n(A),I=r("UYTu")
const S=Object(I.a)(f||(f=v()(["\n    query GetCountries {\n        countries {\n            id\n            full_name_english\n            two_letter_abbreviation\n        }\n    }\n"]))),P=["classes","field","label","translationId"]
function ownKeys(e,t){var r=Object.keys(e)
if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e)
t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}const _=e=>{const t=(e=>{const{queries:{getCountriesQuery:t}}=e,{data:r,error:n,loading:s}=Object(p.b)(t)
let o=[{label:"Loading Countries...",value:""}]
if(!s&&!n){const{countries:e}=r;(o=e.map(e=>({label:e.full_name_english||e.two_letter_abbreviation,value:e.two_letter_abbreviation}))).sort((e,t)=>e.label<t.label?-1:1)}return{countries:o,loading:s}})({queries:{getCountriesQuery:S}}),{countries:r,loading:n}=t,{classes:o,field:i,label:d,translationId:b}=e,f=c()(e,P),{formatMessage:j}=Object(u.a)(),m=Object(y.a)(C,o),h=function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{}
t%2?ownKeys(Object(r),!0).forEach(function(t){a()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({classes:m,disabled:n,field:i,items:r},f)
return l.a.createElement(g.a,{id:m.root,label:j({id:b,defaultMessage:d}),classes:{root:m.root}},l.a.createElement(O.a,s()({},h,{id:m.root})))}
t.a=_
_.defaultProps={field:"country",label:"Country",translationId:"country.label"},_.propTypes={classes:Object(b.shape)({root:b.string}),field:b.string,label:b.string,translationId:b.string,validate:b.func,initialValue:b.string}},XfiJ:function(e,t,r){"use strict"
var n=r("pVnL"),s=r.n(n),o=r("lSNA"),a=r.n(o),i=r("QILm"),c=r.n(i),d=r("q1tI"),l=r.n(d),u=r("17x9"),b=r("dDsW"),p=r("8UhI"),f=r("c3RJ")
var y=r("y1Xp"),g=r("U2T0"),O=r("b1jg"),j=r("LboF"),m=r.n(j),h=r("rheR"),w={injectType:"singletonStyleTag",insert:"head",singleton:!0},C=(m()(h.a,w),h.a.locals||{})
const A=["classes","fieldInput","label"]
function ownKeys(e,t){var r=Object.keys(e)
if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e)
t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}const v=e=>{const{classes:t,fieldInput:r,label:n}=e,o=c()(e,A),i=Object(y.a)(C,t),u=function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{}
t%2?ownKeys(Object(r),!0).forEach(function(t){a()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({classes:i},o),{formatMessage:j}=Object(b.a)(),m=n||j({id:"postcode.label",defaultMessage:"ZIP / Postal Code"})
return(e=>{const{countryCodeField:t="country",fieldInput:r="postcode"}=e,n=Object(d.useRef)(!1),s=Object(f.a)(t),{value:o}=s,a=Object(p.l)(r)
Object(d.useEffect)(()=>{o&&(n.current?a.reset():n.current=!0)},[o,a])})({fieldInput:r}),l.a.createElement(g.a,{id:i.root,label:m,classes:{root:i.root}},l.a.createElement(O.a,s()({},u,{field:r,id:i.root})))}
t.a=v
v.defaultProps={fieldInput:"postcode"},v.propTypes={classes:Object(u.shape)({root:u.string}),fieldInput:u.string,label:u.string}},aNBz:function(e,t,r){"use strict"
r.d(t,"a",function(){return s})
var n=r("q1tI")
const s=e=>{Object(n.useLayoutEffect)(()=>{globalThis.document&&(document.documentElement.dataset.scrollLock=e||"")},[e])}},rheR:function(e,t,r){"use strict"
var n=r("JPst"),s=r.n(n)()(function(e){return e[1]})
s.push([e.i,".postcode-root-ttM {\n}\n",""]),s.locals={root:"postcode-root-ttM"},t.a=s},"x/sB":function(e,t,r){"use strict"
var n=r("pVnL"),s=r.n(n),o=r("lSNA"),a=r.n(o),i=r("QILm"),c=r.n(i),d=r("q1tI"),l=r.n(d),u=r("dDsW"),b=r("17x9"),p=r("+TN3"),f=r("8UhI"),y=r("c3RJ")
var g,O=r("y1Xp"),j=r("U2T0"),m=r("cXIJ"),h=r("b1jg"),w=r("LboF"),C=r.n(w),A=r("0Hm9"),v={injectType:"singletonStyleTag",insert:"head",singleton:!0},I=(C()(A.a,v),A.a.locals||{}),S=r("VkAN"),P=r.n(S),_=r("UYTu")
const E=Object(_.a)(g||(g=P()(["\n    query GetRegions($countryCode: String!) {\n        country(id: $countryCode) {\n            id\n            available_regions {\n                id\n                code\n                name\n            }\n        }\n    }\n"]))),D=["classes","regionError","countryCodeField","fieldInput","fieldSelect","label","translationId","optionValueKey"]
function ownKeys(e,t){var r=Object.keys(e)
if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e)
t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}const k=e=>{const{classes:t,regionError:r,countryCodeField:n,fieldInput:o,fieldSelect:i,label:b,translationId:g,optionValueKey:w}=e,C=c()(e,D),{formatMessage:A}=Object(u.a)(),v=(e=>{const{countryCodeField:t="country",fieldInput:r="region",fieldSelect:n="region",optionValueKey:s="code",queries:{getRegionsQuery:o}}=e,a=Object(d.useRef)(!1),i=Object(y.a)(t),{value:c}=i,l=Object(f.l)(r),u=Object(f.l)(n),{data:b,loading:g}=Object(p.b)(o,{variables:{countryCode:c},skip:!c})
Object(d.useEffect)(()=>{c&&!g&&(a.current?(l.exists()&&l.setValue(),u.exists()&&u.setValue()):a.current=!0)},[c,l,u,g])
let O=[{label:"Loading Regions...",value:""}]
if(b){const{country:e}=b,{available_regions:t}=e
t?(O=t.map(e=>({key:e.id,label:e.name,value:e[s]}))).unshift({disabled:!0,hidden:!0,label:"",value:""}):O=[]}return{loading:g,regions:O}})({countryCodeField:n,fieldInput:o,fieldSelect:i,optionValueKey:w,queries:{getRegionsQuery:E}}),{loading:S,regions:P}=v,_=Object(O.a)(I,t),k=function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{}
t%2?ownKeys(Object(r),!0).forEach(function(t){a()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({classes:_,disabled:S},C),T=P.length||S?l.a.createElement(m.a,s()({regionError:r},k,{field:i,id:_.root,items:P})):l.a.createElement(h.a,s()({},k,{field:o,id:_.root,regionError:r}))
return l.a.createElement(j.a,{id:_.root,label:A({id:g,defaultMessage:b}),classes:{root:_.root}},T)}
t.a=k
k.defaultProps={countryCodeField:"country",fieldInput:"region",fieldSelect:"region",label:"State",translationId:"region.label",optionValueKey:"code"},k.propTypes={classes:Object(b.shape)({root:b.string}),countryCodeField:b.string,fieldInput:b.string,fieldSelect:b.string,label:b.string,translationId:b.string,optionValueKey:b.string,validate:b.func,initialValue:Object(b.oneOfType)([b.number,b.string])}}}])
